# This is a test command reference file for Exercise - 5 in the Red Hat OpenShift DevOps Engineer course 2020

oc new-project yourproject-cicd --display-name="My CICD Project"

oc new-app jenkins-persistent --param MEMORY_LIMIT=2Gi --param DISABLE_ADMINISTRATIVE_MONITORS=true --param ENABLE_OAUTH=true
oc set resources dc jenkins --limits=cpu=2 --requests=cpu=1,memory=2Gi

watch oc get pod

oc get route jenkins -o jsonpath='{.spec.host}{"\n"}'

# Create projects for environments : DEV,TEST, PROD

$ export GUID=health-ui
$ oc new-project pipeline-${GUID}-dev --description="Health UI Development Environment" --display-name="Health UI- Dev"
$ oc new-project pipeline-${GUID}-test --description="Health UI Testing Environment" --display-name="Health UI - Test"
$ oc new-project pipeline-${GUID}-prod --description="Health UI Production Environment" --display-name="Health UI - Prod"

$ oc get projects

$ oc project pipeline-${GUID}-dev

$ oc new-app jenkins-persistent -p ENABLE_OAUTH=true -n pipeline-${GUID}-dev

# Enable the Jenkins service account to manage resources in the pipeline-${GUID}-test and pipeline-${GUID}-prod projects:
$ oc policy add-role-to-user edit system:serviceaccount:pipeline-${GUID}-dev:jenkins -n pipeline-${GUID}-test
$ oc policy add-role-to-user edit system:serviceaccount:pipeline-${GUID}-dev:jenkins -n pipeline-${GUID}-prod

# Enable pulling of images from the pipeline-${GUID}-dev project to the pipeline-${GUID}-test and pipeline-${GUID}-prod projects:
$ oc policy add-role-to-group system:image-puller system:serviceaccounts:pipeline-${GUID}-test -n pipeline-${GUID}-dev
$ oc policy add-role-to-group system:image-puller system:serviceaccounts:pipeline-${GUID}-prod -n pipeline-${GUID}-dev

https://github.com/svennam92/node-s2i-openshift


